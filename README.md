# Отчет о проделаной работе

## Разработка модели для оценки отзывов
Для разработки модели классификации отзывов на фильмы я взял за основу языковую модель `DistilBert` которую потом дообучил на данном датасете. Для этого я произвел следующие шаги:
1) Получение данных. Для начала, из данного датасета я извлек все отзывы о фильмах и создал `.csv` файл со всеми отзывами и значением, был этот отзыв положительнм или отрицательным.
2) Предобработка данных. На этом этапе я произвел стандартные операции над изначальными текстовыми данными для того, чтобы модель могла лучше с ними работать. Для этого я удалил из данных слова, которые не несут смысловой нагрузки, удалил ссылки из текста, удалил данные, находящиеся в квадратных скобках.
3) Токенизация текста. На этом шаге я токенезировал обработанный текст. Для этого я использовал  `DistilBertTokenizerFast`. После токенизации изначальных данных я получаю на выходе 2 тензора - `ids`, который показывает `id` слов отзыва в словаре токенизатора и `attention` , который показыват, какое внимения модель должна уделять определенному слову. Оба этих тензора далее будут использоваться в `transformer` модели, которуб я взял за основу.
4) На следующем шаге я описал конфигурацию базовой трансформер модели, а также заморозил все слои базовой модели для более быстрого и эффективного обучения.
5) На этом шаге на основе фреймворка `pytorch` я написал собственную модель, которая использует результат базовой модели и получает из него нужный результат. Для этого я добавил 1 линейный слой к базовой модели и использовал функцию активации - сигмоид, так как на выходе я хочу получить значение от 0 до 1
6) На этом шаге я произвел все стандартные операции для обучения модели в pytorch это:
 - Указал используемую функцию потерь - Бинарная перекрестная энтропия
 - Указал испльзуемый `optimizer` для градиентного спуска - `Adam Optimizer`
 - Указал используемый `learning rate` и размер батча для стохастического градиентого спуска
 - Реализовал стандартные функции `training` и `validation` в pytorch
 - После 6 эпох обучения я получил `accuracy = 75%` на валидационной выборке
7) Далее я построил общий граффик ответов, которые дала моя модель на тестовой выборке. И основываясь на нем реализовал функцию, котрая будет присваивать отзыву статус и давать оценку. Для этого я разбил все результаты на 10 квантилей, и соновываясь на информации в каком квантиле будет результат работы модели для нового отзыва давать ему оценку. На основе оценки также я классифицирую отзыв как положительный (если оценка больше 5) или отрицательный, (в ином случае).

## Создание веб сервиса
Для создания веб сервиса я использовал фреймворк Django. Для использования его, пользователь должен ввести свой отзыв в текстовое поле. Для обработки полученных данных и получения результата, пользователь должен нажать кнопку `Submit`. После этого пользователя перенаправит на другую страницу, где он сможет увидеть результат, который выдала модель на его отызв. С этой страницы пользватель может вернуться на первоначальную нажав кнопку `Go back!`,  для того, чтобы протестировать можель уже на другом отзыве.